<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events - Samfunds Simulator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“° Events Historik</h1>
            <nav>
                <a href="index.html">ğŸ  Hjem</a>
                <a href="game.html">ğŸ® Spil</a>
                <a href="research.html">ğŸ”¬ Forskning</a>
                <a href="events.html" class="active">ğŸ“° Events</a>
            </nav>
        </header>

        <main>
            <div class="events-container">
                <div class="events-header">
                    <h2>ğŸ“Š Event Statistikker</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>ğŸ“ˆ Totalt</h3>
                            <div class="stat-value" id="total-events">0</div>
                            <div class="stat-label">Events</div>
                        </div>
                        <div class="stat-card">
                            <h3>âœ… Positive</h3>
                            <div class="stat-value" id="positive-events">0</div>
                            <div class="stat-label">Gode Events</div>
                        </div>
                        <div class="stat-card">
                            <h3>âŒ Negative</h3>
                            <div class="stat-value" id="negative-events">0</div>
                            <div class="stat-label">DÃ¥rlige Events</div>
                        </div>
                        <div class="stat-card">
                            <h3>ğŸ¯ Mest Almindelige</h3>
                            <div class="stat-value" id="most-common-event">-</div>
                            <div class="stat-label">Event Type</div>
                        </div>
                    </div>
                </div>

                <div class="events-controls">
                    <h3>ğŸ” Filtrer Events</h3>
                    <div class="filter-controls">
                        <label>
                            <input type="checkbox" id="show-positive" checked> 
                            âœ… Positive Events
                        </label>
                        <label>
                            <input type="checkbox" id="show-negative" checked> 
                            âŒ Negative Events
                        </label>
                        <label>
                            Vis sidste: 
                            <select id="years-filter">
                                <option value="5">5 Ã¥r</option>
                                <option value="10" selected>10 Ã¥r</option>
                                <option value="20">20 Ã¥r</option>
                                <option value="50">50 Ã¥r</option>
                                <option value="100">Alle</option>
                            </select>
                        </label>
                        <button onclick="updateEventHistory()" class="refresh-btn">ğŸ”„ Opdater</button>
                    </div>
                </div>

                <div class="events-timeline">
                    <h3>ğŸ“… Event Historik</h3>
                    <div id="events-list">
                        <div class="no-events">
                            <p>Ingen events endnu...</p>
                            <p><small>Events begynder at ske nÃ¥r du nÃ¥r Tier 1 forskning!</small></p>
                        </div>
                    </div>
                </div>

                <div class="events-info">
                    <h3>â„¹ï¸ Om Events</h3>
                    <div class="info-content">
                        <p><strong>Hvordan fungerer events?</strong></p>
                        <ul>
                            <li><strong>Tier 0:</strong> Ingen events kan ske</li>
                            <li><strong>Tier 1:</strong> 0-5 events per Ã¥r (afhÃ¦nger af byens stÃ¸rrelse)</li>
                            <li><strong>Tier 2+:</strong> Flere events bliver tilgÃ¦ngelige</li>
                        </ul>
                        
                        <p><strong>Event Typer (Tier 1):</strong></p>
                        <ul>
                            <li>ğŸ‘¶ <strong>FÃ¸dsler:</strong> Baby boom Ã¸ger befolkning og tilfredshed</li>
                            <li>âš°ï¸ <strong>DÃ¸dsfald:</strong> Naturlige dÃ¸dsfald reducerer befolkning</li>
                            <li>ğŸ¦  <strong>Epidemi:</strong> Sygdom rammer byen (mindre sandsynligt med hospitaler)</li>
                            <li>ğŸ‰ <strong>Festival:</strong> Byfestival Ã¸ger tilfredshed og giver penge</li>
                            <li>ğŸ”¥ <strong>Brand:</strong> Skader byens Ã¸konomi</li>
                        </ul>
                        
                        <p><strong>Tips:</strong></p>
                        <ul>
                            <li>StÃ¸rre byer har flere events</li>
                            <li>HÃ¸j tilfredshed Ã¸ger chancen for positive events</li>
                            <li>Hospitaler reducerer risiko for epidemier</li>
                            <li>Events har cooldown-perioder</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="game-logic.js"></script>
    <script src="events.js"></script>
    <script>
        // Opdater event historik
        function updateEventHistory() {
            if (!window.eventManager) {
                console.log('Event manager not ready');
                return;
            }
            
            const yearsFilter = parseInt(document.getElementById('years-filter').value);
            const showPositive = document.getElementById('show-positive').checked;
            const showNegative = document.getElementById('show-negative').checked;
            
            let events = window.eventManager.getEventHistory(yearsFilter);
            
            // Filtrer efter type
            events = events.filter(event => {
                if (event.type === 'positive' && !showPositive) return false;
                if (event.type === 'negative' && !showNegative) return false;
                return true;
            });
            
            const eventsList = document.getElementById('events-list');
            
            if (events.length === 0) {
                eventsList.innerHTML = `
                    <div class="no-events">
                        <p>Ingen events matcher dine filtre...</p>
                        <p><small>PrÃ¸v at justere filtrene eller spil videre for at opleve events!</small></p>
                    </div>
                `;
                return;
            }
            
            // Sorter efter Ã¥r (nyeste fÃ¸rst)
            events.sort((a, b) => b.year - a.year);
            
            let html = '';
            events.forEach(event => {
                const typeClass = event.type === 'positive' ? 'positive' : 'negative';
                const typeIcon = event.type === 'positive' ? 'âœ…' : 'âŒ';
                
                html += `
                    <div class="event-item ${typeClass}">
                        <div class="event-header">
                            <span class="event-year">Ã…r ${event.year}</span>
                            <span class="event-type">${typeIcon}</span>
                        </div>
                        <div class="event-title">${event.name}</div>
                        <div class="event-message">${event.message}</div>
                        <div class="event-effects">
                            ${event.effects.population ? `ğŸ‘¥ ${event.effects.population > 0 ? '+' : ''}${event.effects.population} borgere` : ''}
                            ${event.effects.happiness ? `ğŸ˜Š ${event.effects.happiness > 0 ? '+' : ''}${event.effects.happiness}% tilfredshed` : ''}
                            ${event.effects.money ? `ğŸ’° ${event.effects.money > 0 ? '+' : ''}${event.effects.money.toLocaleString()} kr` : ''}
                        </div>
                    </div>
                `;
            });
            
            eventsList.innerHTML = html;
        }
        
        // Opdater statistikker
        function updateEventStatistics() {
            if (!window.eventManager) {
                return;
            }
            
            const stats = window.eventManager.getEventStatistics();
            
            document.getElementById('total-events').textContent = stats.totalEvents;
            document.getElementById('positive-events').textContent = stats.positiveEvents;
            document.getElementById('negative-events').textContent = stats.negativeEvents;
            
            // Find mest almindelige event navn
            let mostCommonName = '-';
            if (stats.mostCommonEvent && window.eventManager.availableEvents.tier1) {
                const event = window.eventManager.availableEvents.tier1.find(e => e.id === stats.mostCommonEvent);
                if (event) {
                    mostCommonName = event.name;
                }
            }
            document.getElementById('most-common-event').textContent = mostCommonName;
        }
        
        // Event listeners
        document.getElementById('show-positive').addEventListener('change', updateEventHistory);
        document.getElementById('show-negative').addEventListener('change', updateEventHistory);
        document.getElementById('years-filter').addEventListener('change', updateEventHistory);
        
        // Initialiser siden
        function initializeEventsPage() {
            // IndlÃ¦s spil data
            if (typeof initializeGame === 'function') {
                initializeGame();
            }
            
            // Opdater efter kort forsinkelse
            setTimeout(() => {
                updateEventStatistics();
                updateEventHistory();
            }, 100);
        }
        
        // Automatisk opdatering
        setInterval(() => {
            updateEventStatistics();
            updateEventHistory();
        }, 5000);
        
        // Start nÃ¥r siden er klar
        window.addEventListener('load', initializeEventsPage);
    </script>
</body>
</html>
